<%@ page contentType="text/html; charset=UTF-8"%>
<!DOCTYPE html>
<html>
    <head>
      <!-- 포트원 SDK 라이브러리 추가 -->
      <script src="https://cdn.iamport.kr/v1/iamport.js"></script>
      
      <script>
   // 객체 초기화
        var IMP = window.IMP;
        IMP.init('imp87501644');

        function requestPay() {
          // 결제창 호출      
        	IMP.request_pay({ 
        		
        		pg : 'kakaopay',
        	    pay_method : 'card', //생략 가능
        	    merchant_uid: "order_no_00024", // 상점에서 관리하는 주문 번호 계속 바뀌어야 함.
        	    name : '주문명:결제테스트',
        	    amount : 9900,
        	    buyer_email : 'iamport@siot.do',
        	    buyer_name : '구매자이름',
        	    buyer_tel : '010-1234-5678',
        	    buyer_addr : '서울특별시 강남구 삼성동',
        	    buyer_postcode : '123-456'
        		
        	},
        			  rsp => {
        			    if (rsp.success) {
        			      // axios로 HTTP 요청
        			      axios({
        			        url: "{서버의 결제 정보를 받는 endpoint}",
        			        method: "post",
        			        headers: { "Content-Type": "application/json" },
        			        data: {
        			          imp_uid: rsp.imp_uid,
        			          merchant_uid: rsp.merchant_uid
        			        }
        			      }).then((data) => {
        			        // 서버 결제 API 성공시 로직
        			      })
        			    } else {
        			      alert(`결제에 실패하였습니다. 에러 내용: ${rsp.error_msg}`);
        			    }
        			  });
      }
      </script>
      <meta charset="UTF-8" />
      <title>Sample Payment</title>
    </head>
    <body>
      <!-- 결제하기 버튼 생성 -->
      <button onclick="requestPay()">결제하기</button>
    </body>
  </html>
