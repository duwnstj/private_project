<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<!DOCTYPE html>
  <html lang="en">
    <head>
      <!-- 포트원 SDK 라이브러리 추가 -->
      <script src="https://cdn.iamport.kr/v1/iamport.js"></script>
      <script>
   // 객체 초기화
        var IMP = window.IMP;
        IMP.init("imp87501644");

        function requestPay() {
          // 결제창 호출      
          IMP.request_pay(
            {
              // 파라미터 값 설정 
              pg: "kakaopay",
              pay_method: "kakaopay",
              merchant_uid: "57008833-33024", // 상점 고유 주문번호
              name: "포트원 테스트",
              amount: 1004,
              buyer_email: "good@portone.io",
              buyer_name: "포트원 기술지원팀",
              buyer_tel: "010-1234-5678",
              buyer_addr: "서울특별시 강남구 삼성동",
              buyer_postcode: "123-456",
            },
            
            
            rsp => {
                if (rsp.success) {
                  // axios로 HTTP 요청
                  axios({
                    url: "{서버의 결제 정보를 받는 endpoint}",
                    method: "post",
                    headers: { "Content-Type": "application/json" },
                    data: {
                      imp_uid: rsp.imp_uid,
                      merchant_uid: rsp.merchant_uid
                    }
                  }).then((data) => {
                	  alert('결제에 성공하였습니다.');
                  })
                } else {
                  alert('결제에 실패하였습니다. 에러 내용: ${rsp.error_msg}');
                }
              });  
      }
      </script>
      <meta charset="UTF-8" />
      <title>Sample Payment</title>
    </head>
    <body>
      <!-- 결제하기 버튼 생성 -->
      <button onclick="requestPay()">결제하기</button>
    </body>
  </html>